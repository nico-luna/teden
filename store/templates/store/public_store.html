<!-- store/public_store.html -->
{% include "partials/header.html" %}
{% include "partials/login_modal.html" %}
{% include "partials/register_modal.html" %}
{% include "partials/cart_modal.html" %}


{% block content %}
<div class="container py-4" style="background: #f8fafc; border-radius: 1rem; box-shadow: 0 2px 16px rgba(0,0,0,0.07);">
  <div class="text-center mb-4">
    {% if store.logo %}
      <img src="{{ store.logo.url }}" class="img-fluid rounded-circle shadow" alt="Logo de la tienda" style="max-width: 100px; background: #fff; padding: 8px;">
    {% endif %}
    <h1 class="mt-3 mb-1" style="font-weight: 700; color: #2d3748;">{{ store.name }}</h1>
    {% if store.banner %}
      <img src="{{ store.banner.url }}" class="img-fluid rounded shadow mb-2" alt="Banner de la tienda" style="max-width: 420px;">
    {% endif %}
    <p class="lead text-muted">{{ store.description|default:"Bienvenido a nuestra tienda." }}</p>
  </div>

{% for block in blocks %}
  {% if block.type == 'hero' %}
    <!-- <div class="text-muted small mb-2">ID: {{ block.id|default:'N/A' }} | Imagen: {{ block.content.background_image|default:'Sin imagen' }}</div> -->
  {% endif %}
  {% if block.type == 'hero' %}
    {% if block.content.background_image %}
      <section class="hero-section mb-4" style="background-image: url('{{ block.content.background_image }}'); background-size: cover; background-position: center; min-height: 320px; border-radius: 1rem; box-shadow: 0 2px 16px rgba(0,0,0,0.09);">
        <div class="container py-5 text-center text-white" style="background: rgba(0,0,0,0.35); border-radius: 1rem;">
          <h1 style="font-size: 2.5rem; font-weight: 700;">{{ block.content.title }}</h1>
          <p style="font-size: 1.2rem;">{{ block.content.subtitle }}</p>
          {% if block.content.cta_text and block.content.cta_url %}
            <a href="{{ block.content.cta_url }}" class="btn btn-light btn-lg mt-3 shadow">{{ block.content.cta_text }}</a>
          {% endif %}
        </div>
      </section>
    {% else %}
      <section class="hero-section bg-light py-5 text-center">
        <h1>{{ block.content.title }}</h1>
        <p>{{ block.content.subtitle }}</p>
        {% if block.content.cta_text and block.content.cta_url %}
          <a href="{{ block.content.cta_url }}" class="btn btn-primary mt-3">{{ block.content.cta_text }}</a>
        {% endif %}
      </section>
    {% endif %}
  {% elif block.type == 'about' %}
      <section class="about-section py-4 mb-4">
        <div class="container">
          <h2 class="mb-3" style="color: #3182ce; font-weight: 600;">{{ block.content.title|default:"Sobre Nosotros" }}</h2>
          {% if block.content.image %}
            <div class="mb-4 text-center">
              <img src="{{ block.content.image }}" class="img-fluid rounded shadow" alt="Imagen de sección" style="max-width: 340px;">
            </div>
          {% endif %}
          <p class="text-muted">{{ block.content.text|default:"Descripción de la tienda." }}</p>
        </div>
      </section>
  {% elif block.type == 'products' %}
    <section class="products-section py-4 mb-4">
      <div class="container">
        <h2 class="mb-3" style="color: #38a169; font-weight: 600;">{{ block.content.title|default:"Productos" }}</h2>
        <div class="row">
          {% for product in store.owner.sold_products.all %}
            <div class="col-md-4 mb-4">
              <div class="card h-100 border-0 shadow-sm">
                {% if product.image %}
                  <img src="{{ product.image.url }}" class="card-img-top rounded-top" alt="{{ product.name }}" style="height: 180px; object-fit: cover;">
                {% endif %}
                <div class="card-body">
                  <h5 class="card-title" style="font-weight: 600;">{{ product.name }}</h5>
                  <p class="card-text text-muted">{{ product.description|default:"Sin descripción" }}</p>
                  <p class="card-text text-success" style="font-size: 1.1rem; font-weight: 700;">${{ product.price }}</p>
                </div>
              </div>
            </div>
          {% empty %}
            <p class="text-muted">No hay productos publicados.</p>
          {% endfor %}
        </div>
      </div>
    </section>
  {% elif block.type == 'testimonial' %}
    <section class="testimonial-section py-4 mb-4">
      <div class="container">
        <h2 class="mb-3" style="color: #ed8936; font-weight: 600;">{{ block.content.title|default:"Testimonios" }}</h2>
        {% if block.content.image %}
          <div class="mb-4 text-center">
            <img src="{{ block.content.image }}" class="img-fluid rounded-circle shadow" alt="Imagen del autor" style="max-width: 120px;">
          </div>
        {% endif %}
        <blockquote class="blockquote text-muted" style="font-size: 1.1rem;">
          <p>{{ block.content.text|default:"Sin testimonios aún." }}</p>
        </blockquote>
      </div>
    </section>
  {% elif block.type == 'contact' %}
    <section class="contact-section py-4 mb-4">
      <div class="container">
        <h2 class="mb-3" style="color: #4299e1; font-weight: 600;">{{ block.content.title|default:"Contacto" }}</h2>
        <div class="row justify-content-center">
          <div class="col-md-6">
            <div class="card border-0 shadow-sm p-3">
              <p class="mb-2"><strong>Email:</strong> <span class="text-muted">{{ store.contact_email|default:"No disponible" }}</span></p>
              <p class="mb-2"><strong>Teléfono:</strong> <span class="text-muted">{{ store.contact_phone|default:"No disponible" }}</span></p>
              <p class="mb-0"><strong>Dirección:</strong> <span class="text-muted">{{ store.address|default:"No disponible" }}</span></p>
            </div>
          </div>
        </div>
      </div>
    </section>
  {% endif %}
{% endfor %}
{% endblock %}
