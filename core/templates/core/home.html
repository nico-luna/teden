<body>
{% include "partials/header.html" %}
{% include "partials/login_modal.html" %}
{% include "partials/register_modal.html" %}
{% include "partials/cart_modal.html" %}
<!-- Cargar archivos estáticos -->
{% load static %}
<!-- <link rel="stylesheet" href="{'core/css/global.css' %}"> -->
<link rel="icon" href="{% static 'img/favicon.ico' %}">


{% block content %}

 <main>
  <!-- Hero / Carousel -->

<div id="mainCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      {% load static %}
      <img src="{% static 'banners/1.png' %}" class="d-block w-100" alt="Promo 1">
    </div>
    <div class="carousel-item active">
      {% load static %}
      <img src="{% static 'banners/2.png' %}" class="d-block w-100" alt="Promo 1">
    </div>
    <div class="carousel-item">
      {% load static %}
      <img src="{% static 'banners/3.png' %}" class="d-block w-100" alt="Promo 2">
    </div>
    <div class="carousel-item">
      {% load static %}
      <img src="{% static 'banners/4.png' %}" class="d-block w-100" alt="Promo 2">
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>

<!-- Sección de beneficios -->

<section class="container py-5">
  <h2 class="text-center mb-5 fw-bold" style="font-size:2.2rem; letter-spacing:-1px;">¿Por qué elegir TEDEN?</h2>
  <div class="row justify-content-center g-4">
    {% for img, titulo, texto in beneficios %}
      <div class="col-12 col-sm-6 col-md-3">
        <div class="bg-white rounded-4 shadow-sm p-4 h-100 d-flex flex-column align-items-center gap-3 border-0" style="min-height:260px;">
          <img src="{% static 'beneficios/' %}{{ img }}" alt="{{ titulo }}" style="height:64px; margin-bottom:12px;">
          <h6 class="fw-semibold mb-2" style="font-size:1.1rem;">{{ titulo }}</h6>
          <p class="text-muted text-center" style="font-size:0.98rem;">{{ texto }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
</section>



<!-- Sección de planes -->

<section class="container py-5">
  <h2 class="text-center mb-5 fw-bold" style="font-size:2.2rem; letter-spacing:-1px;">Elegí el plan ideal para vos</h2>
  <div class="row justify-content-center g-4">
    <div class="col-12 col-md-4">
      <div class="bg-white rounded-4 shadow-sm p-4 h-100 border-0 d-flex flex-column gap-2">
        <h5 class="fw-bold mb-2">TEDEN Starter <span class="badge bg-light text-dark ms-2">Gratis</span></h5>
        <p class="text-muted mb-3">Ideal para quienes están comenzando en el mundo digital.</p>
        <ul class="list-unstyled mb-0" style="font-size:1rem;">
          <li>📦 Hasta 3 productos digitales</li>
      <li>🛠️ 1 servicio o trabajo publicado</li>
      <li>🛍️ Tienda digital solo personal</li>
      <li>💸 Comisión: 20%</li>
        </ul>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="bg-white rounded-4 shadow-sm p-4 h-100 border-0 d-flex flex-column gap-2">
        <h5 class="fw-bold mb-2">TEDEN Plus <span class="badge bg-success ms-2">USD 9,99 / mes</span></h5>
        <p class="text-muted mb-3">Más herramientas para creadores en expansión.</p>
        <ul class="list-unstyled mb-0" style="font-size:1rem;">
          <li>📦 Hasta 20 productos/archivos/licencias</li>
      <li>🛠️ Servicios y trabajos ilimitados</li>
      <li>🛍️ Hasta 3 tiendas digitales activas</li>
      <li>🚀 1 producto promocionado</li>
      <li>💸 Comisión: 13%</li>
      <li>✅ Creador verificado</li>
        </ul>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="bg-white rounded-4 shadow-sm p-4 h-100 border-0 d-flex flex-column gap-2">
        <h5 class="fw-bold mb-2">TEDEN Pro <span class="badge bg-warning text-dark ms-2">USD 19,99 / mes</span></h5>
        <p class="text-muted mb-3">Para profesionales, agencias y vendedores de alto volumen.</p>
        <ul class="list-unstyled mb-0" style="font-size:1rem;">
          <li>♾️ Publicaciones ilimitadas</li>
          <li>🏬 Tiendas ilimitadas por nicho</li>
          <li>🚀 Hasta 3 productos promocionados</li>
          <li>⚡ Soporte prioritario</li>
          <li>💸 Comisión: 7%</li>
          <li>✅ Creador verificado</li>
        </ul>
      </div>
    </div>
  </div>
</section>





<!-- Catálogo de productos -->

<section class="container py-5">
  <h2 class="mb-5 fw-bold text-center" style="font-size:2.2rem; letter-spacing:-1px;">Catálogo de Productos</h2>
  <div class="row g-4">
    {% for producto in productos %}
      <div class="col-12 col-sm-6 col-md-4 col-lg-3">
        <div class="bg-white rounded-4 shadow-sm h-100 d-flex flex-column border-0 p-0 card-hover" data-product-id="{{ producto.id }}">
          {% if producto.image %}
            <a href="{% url 'product_detail' producto.id %}" tabindex="-1">
              <img src="{{ producto.image.url }}" class="rounded-top-4" style="height:180px; object-fit:cover; width:100%; background:#f5f6fa;" alt="{{ producto.name }}">
            </a>
          {% else %}
            <a href="{% url 'product_detail' producto.id %}" tabindex="-1">
              <div class="bg-light rounded-top-4 d-flex align-items-center justify-content-center" style="height:180px; width:100%;">Sin imagen</div>
            </a>
          {% endif %}
          <div class="p-4 d-flex flex-column flex-grow-1">
            <h5 class="fw-semibold mb-2" style="font-size:1.1rem;">{{ producto.name }}</h5>
            <p class="text-muted mb-3" style="font-size:0.98rem; min-height:2.5em;">{{ producto.description }}</p>
            <div class="mt-auto d-flex flex-column gap-2">
              <span class="fw-bold text-success" style="font-size:1.1rem;">${{ producto.price }}</span>
              <a href="{% url 'product_detail' producto.id %}" class="btn btn-outline-dark w-100">
                Ver más
              </a>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</section>
</main>

{% include "partials/footer.html" %}



<!-- Modal de detalles -->
{% include "partials/product_modal.html" with product=product %}

{% endblock %}

<script>
document.addEventListener("DOMContentLoaded", function () {
  const modal = document.getElementById('productDetailModal');

  modal.addEventListener('show.bs.modal', function (event) {
    const button = event.relatedTarget;
    const productId = button.getAttribute('data-product-id');

  fetch(`/products/detalle-json/${productId}/`)
      .then(response => response.json())
      .then(data => {
        console.log('🔎 Data recibida del producto:', data);

        document.getElementById('modalProductName').textContent = data.name || 'Sin nombre';
        document.getElementById('modalProductDescription').textContent = data.description || 'Sin descripción';
        document.getElementById('modalProductPrice').textContent = data.price || '0.00';
        document.getElementById('modalProductImage').src = data.image || 'https://via.placeholder.com/400x200?text=Sin+imagen';
        
        // Promedio de valoraciones
        document.getElementById('modalProductRating').textContent = data.avg_rating 
          ? `⭐ ${data.avg_rating} / 5` 
          : '⭐ Sin valoraciones';

        // Cargar reseñas
        const reviewsContainer = document.getElementById('reviewsContainer');
        reviewsContainer.innerHTML = '';

        if (data.reviews && data.reviews.length > 0) {
          data.reviews.forEach(review => {
            const reviewDiv = document.createElement('div');
            reviewDiv.className = 'border rounded p-3 mb-2';
            reviewDiv.innerHTML = `
              <strong>${review.user}</strong> - ⭐ ${review.rating}/5<br>
              <small class="text-muted">${review.date}</small>
              <p class="mb-0">${review.comment}</p>
            `;
            reviewsContainer.appendChild(reviewDiv);
          });
        } else {
          reviewsContainer.innerHTML = '<p class="text-muted">Sin reseñas aún.</p>';
        }
      })
      .catch(error => console.error('❌ Error cargando el producto:', error));
  });
});
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll('.card-hover').forEach(function(card) {
    card.addEventListener('click', function(e) {
      // Evitar que el click en el botón o imagen seleccione la card
      if (e.target.tagName === 'BUTTON' || e.target.tagName === 'IMG' || e.target.tagName === 'A') return;
      document.querySelectorAll('.card-hover.selected').forEach(function(c) { c.classList.remove('selected'); });
      card.classList.add('selected');
    });
  });
});
</script>

{% if show_register_modal %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const modal = new bootstrap.Modal(document.getElementById('registerModal'));
    modal.show();
  });
</script>
{% endif %}

</body>
